#!/bin/bash

# Script for updating data.  After pulling and merging, it will
# regenerate the history & update the notebooks.

# First, pull and merge latest data first, as in:
#    git fetch --all -p
#    git merge nychealth/master

# Then run this script

# Clear out previous datasets
rm all_versions_exported/*

# Pull old history
Scripts/git-export-all-file-versions ./case-hosp-death.csv

# Pull new history
Scripts/git-export-all-file-versions ./Trends/data-by-day.csv

# Generate history.csv file:
python Scripts/generate-history.py

# Update Analysis:

jupyter nbconvert --to notebook --inplace --execute Notebooks/Analysis.ipynb

# Update Growth:

jupyter nbconvert --to notebook --inplace --execute Notebooks/Growth.ipynb

# Update report dt vs incident date:

jupyter nbconvert --to notebook --inplace --execute Notebooks/Reporting.ipynb

# Update graphs for slides

jupyter nbconvert --to notebook --inplace --execute Notebooks/TalkSlides.ipynb

